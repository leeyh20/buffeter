
{% extends 'buffetinfo/base.html' %}

{% block head %}
{% for buffet in buffets %}
<script type = "text/javascript">
    function detail_{{buffet.pk}}_toggle() {
        $("#detail_{{buffet.pk}}").slideToggle();
    }
</script>
{% endfor %}
{% endblock %}

{% block navicon %}
<button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-top-menu-collapse">
    <i class="glyphicon glyphicon-list"></i>
</button>
{% endblock %}

{% block nav %}
<div class="collapse navbar-collapse navbar-top-menu-collapse col-sm-8">
    <ul class="nav navbar-nav">
        <li class="dropdown">
            <a class="dropdown-toggle" href="#" data-toggle="dropdown">Buffets <b class="caret"></b></a>
            <ul class="dropdown-menu white">
                <h2> Sort by: </h2>
                <h2> Filter by: </h2>
    <form method="POST" class="post-form">{%csrf_token %}
        {{ form.as_p}}
        <!-- <button type="submit" class="save btn" btn-default> Filter now!</button> -->
    </form>
                <li class="divider"></li>
                <li><a href="./bbs/board.php?bo_table=apache_tips">Promotions</a></li>
            </ul>
        </li>
    </ul>
    </div>
{% endblock %}

{% block content %}

	{% if user.is_staff %}
    <h1> Welcome, staff! </h1>
    {% endif %}
    
    {% if search_term != "" %}
        <h2> Searching for: {{ search_term }} </h2>
    {% else %}
        <h2> Buffets </h2>
    {% endif %}

    {% for buffet in buffets %}

        <div class = "buffet" onclick = "detail_{{buffet.pk}}_toggle();">
        		<div class = "row">
		    		<div class = "col-sm-9">
                        <div class = "date">
                            <p>published: {{ buffet.published_date }} <br>
                            created: {{ buffet.created_date }} </p>
                        </div>
		            <h1><a href="{% url 'buffet_detail' pk=buffet.pk %}">{{ buffet.name }}</a></h1>
		            <h3>Cuisine Type: {{ buffet.cuisine_type}}</h3>
		            <h3> Location: {{ buffet.location }} </h3>
                    <h3> Address: {{ buffet.address }} </h3>
		            <h3> Opening hours: {{ buffet.hrs_opening }} </h3>
		            <h3> Closing hours: {{ buffet.hrs_closing }} </h3>
		            <h3> Contact Number: {{ buffet.phone_number }} </h3>

                    <div id = "detail_{{buffet.pk}}" style="display:none">
		            <div class = "price">
                    <style type="text/css">
                    .tg  {border-collapse:collapse;border-spacing:0;}
                    .tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
                    .tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
                    .tg .tg-yw4l{vertical-align:top}
                    </style>
                    <table class="tg">
                        <tr>
                            <th class="tg-yw4l" rowspan="2"></th>
                            <th class="tg-yw4l" colspan="2">Weekday</th>
                            <th class="tg-yw4l" colspan="2">Weekend</th>
                        </tr>
                        <tr>
                            <td class="tg-yw4l">Adult</td>
                            <td class="tg-yw4l">Child</td>
                            <td class="tg-yw4l">Adult</td>
                            <td class="tg-yw4l">Child</td>
                        </tr>
                        <tr>
                            <td class="tg-yw4l">Breakfast</td>
                            <td class="tg-yw4l">{{ buffet.weekday_adult_breakfast_price|default_if_none:"Not available" }}</td>
                            <td class="tg-yw4l">{{ buffet.weekday_child_breakfast_price|default_if_none:"Not available" }}</td>
                            <td class="tg-yw4l">{{ buffet.weekend_adult_breakfast_price|default_if_none:"Not available" }}</td>
                            <td class="tg-yw4l">{{ buffet.weekend_child_breakfast_price|default_if_none:"Not available" }}</td>
                        </tr>
                        <tr>
                            <td class="tg-yw4l">Lunch</td>
                            <td class="tg-yw4l">{{ buffet.weekday_adult_lunch_price }}</td>
                            <td class="tg-yw4l">{{ buffet.weekday_child_lunch_price|default_if_none:"Not available" }}</td>
                            <td class="tg-yw4l">{{ buffet.weekend_adult_lunch_price }}</td>
                            <td class="tg-yw4l">{{ buffet.weekend_child_lunch_price|default_if_none:"Not available" }}</td>
                        </tr>
                        <tr>
                            <td class="tg-yw4l">High Tea</td>
                            <td class="tg-yw4l">{{ buffet.weekday_adult_hightea_price|default_if_none:"Not available" }}</td>
                            <td class="tg-yw4l">{{ buffet.weekday_child_hightea_price|default_if_none:"Not available" }}</td>
                            <td class="tg-yw4l">{{ buffet.weekend_adult_hightea_price|default_if_none:"Not available" }}</td>
                            <td class="tg-yw4l">{{ buffet.weekend_child_hightea_price|default_if_none:"Not available" }}</td>
                        </tr>
                        <tr>
                            <td class="tg-yw4l">Dinner</td>
                            <td class="tg-yw4l">{{ buffet.weekday_adult_dinner_price }}</td>
                            <td class="tg-yw4l">{{ buffet.weekday_child_dinner_price|default_if_none:"Not available"  }}</td>
                            <td class="tg-yw4l">{{ buffet.weekend_adult_dinner_price }}</td>
                            <td class="tg-yw4l">{{ buffet.weekend_child_dinner_price|default_if_none:"Not available"  }}</td>
                        </tr>
                    </table>
                    
                </div>
                <p>{{  buffet.desc|linebreaksbr }}</p>

		            <br>
		            <a href="{% url 'buffetinfo.views.buffet_detail' pk=buffet.pk %}"> Reviews: {{ buffet.approved_reviews.count }}</a>
                </div>
		            </div>
		            
		            <div class = "col-sm-3">
		            	<h2> Rating: {{ buffet.average_rating }}/5 </h2>
		            </div>
	    </div>
	 </div>
    {% endfor %}
{% endblock %}