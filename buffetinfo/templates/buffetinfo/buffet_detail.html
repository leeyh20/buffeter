{% extends 'buffetinfo/base.html' %}

{% block content %}
    <div class="buffet">
        {% if buffet.published_date %}
            <div class="date">
                {{ buffet.published_date }}
            </div>
        {% else %}
        <a class="btn btn-default" href="{% url 'buffetinfo.views.buffet_publish' pk=buffet.pk %}">Publish</a>
        {% endif %}

        {% if user.is_authenticated %}
        	<a class="btn btn-default" href="{% url 'buffet_edit' pk=buffet.pk %}"><span class="glyphicon glyphicon-pencil"></span></a>
        	<a class="btn btn-default" href="{% url 'buffet_remove' pk=buffet.pk %}"><span class="glyphicon glyphicon-remove"></span></a>
       	{% endif %}
        <h1>{{ buffet.name }}</h1>
        <p>{{  buffet.desc|linebreaksbr }}</p>
    </div>

    <hr>
    <a class="btn btn-default" href="{% url 'add_review_to_buffet' pk=buffet.pk %}">Add Review</a>
    {% for review in buffet.reviews.all %}
        {% if user.is_authenticated or review.approved_review %}
            <div class="review">
                <div class="date">
                    {{ review.created_date }}
                    {% if not comment.approved_comment %}
                        <a class="btn btn-default" href="{% url 'review_remove' pk=review.pk %}"><span class="glyphicon glyphicon-remove"></span></a>
                        <a class="btn btn-default" href="{% url 'review_approve' pk=review.pk %}"><span class="glyphicon glyphicon-ok"></span></a>
                    {% endif %}
                </div>
                <strong>{{ review.user_name }}</strong>
                <p>{{ review.comment|linebreaks }}</p>
            </div>
            {% endif %}
    {% empty %}
        <p>No reviews yet :(</p>
    {% endfor %}
{% endblock %}